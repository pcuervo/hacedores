function creaMapa(){var e=new google.maps.Map(document.getElementById("mapa"),{zoom:15,mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControl:!1,streetViewControl:!1,panControl:!1,scrollwheel:!1,zoomControlOptions:{position:google.maps.ControlPosition.RIGHT_BOTTOM}});return e}function creaMarkers(e,t){var n={},i=[];return $.each(t,function(t,o){n[t]={},$.each(o,function(e,i){return"object"!=typeof i?!0:(n[t][i]=[],n[t][i].push({titulo:i[0],lat:i[1],lon:i[2],slug:i[3]}),void 0)});var a=dameMarkers(t,n[t],e);i=i.concat(a)}),i}function agregaFiltrosMarkers(e,t){$.each(arrayMapa,function(n,i){$("li."+n).on("click",function(){filtraMarkerCategoria(n,t,e)}),$.each(i,function(i,o){return"object"!=typeof o?!0:($("ul.sub-"+n+" li."+o[3]).on("click",function(){filtraMarkerSubCategoria(n,o[3],t,e)}),void 0)})})}function dameMarkers(e,t,n){if(isEmpty(t))return new Array;var i,o=new Array;ubicaciones=[];var a=new google.maps.InfoWindow({maxWidth:400});$.each(t,function(e,t){$.each(t,function(t,n){var i=[],o="<h3>"+n.titulo+"</h3>";i.push(e),i.push(n.lat),i.push(n.lon),i.push(o),i.push(n.slug),ubicaciones.push(i)})});for(var r=dameIconPath(e),s=0;s<ubicaciones.length;s++)i=new google.maps.Marker({position:new google.maps.LatLng(ubicaciones[s][1],ubicaciones[s][2]),map:n,icon:r,category:e,subcategory:ubicaciones[s][4]}),o.push(i),google.maps.event.addListener(i,"click",function(e,t){return function(){a.setContent(ubicaciones[t][3]),a.open(n,e)}}(i,s));return o}function filtraMarkerCategoria(e,t,n){var i=t.filter(function(t){return t.category==e});$.each(t,function(e,t){t.setVisible(!1)});var o=[];$.each(i,function(e,t){t.setVisible(!0),o.push(t)}),autoCenter(n,o)}function filtraMarkerSubCategoria(e,t,n,i){var o=n.filter(function(n){return n.subcategory==t&&n.category==e});$.each(n,function(e,t){t.setVisible(!1)});var a=[];$.each(o,function(e,t){t.setVisible(!0),a.push(t)}),autoCenter(i,a)}function autoCenter(e,t){console.log("autocentering...");var n=new google.maps.LatLngBounds;$.each(t,function(e,t){n.extend(t.position)}),e.fitBounds(n);var i=google.maps.event.addListener(e,"idle",function(){e.getZoom()>17&&e.setZoom(17),google.maps.event.removeListener(i)})}function dameIconPath(e){switch(e){case"hacedores":icon_path=theme_path+"marker-hacedores.png";break;case"evento":icon_path=theme_path+"marker-eventos.png";break;case"recurso":icon_path=theme_path+"marker-espacios.png";break;case"proyecto":icon_path=theme_path+"marker-proyectos.png"}return icon_path}function isEmpty(e){var t=Object.prototype.hasOwnProperty;if(null==e)return!0;if(e.length>0)return!1;if(0===e.length)return!0;for(var n in e)if(t.call(e,n))return!1;return!0}!function(e){"use strict";e(function(){window.validateEmail=function(e){var t=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(e)},window.getFormData=function(t){var n=[],i=e(t).serializeArray();return e.map(i,function(e){n[e.name]=e.value}),n}}),e(document).ready(function(){e("#thing-with-videos").fitVids()}),e(document).ready(function(){e("#menu-movil").mmenu()}),e(function(){var t=function(){e('<div id="imagelightbox-loading"><div></div></div>').appendTo("body")},n=function(){e("#imagelightbox-loading").remove()},i=function(){e('<div id="imagelightbox-overlay"></div>').appendTo("body")},o=function(){e("#imagelightbox-overlay").remove()},a=function(t){e('<a id="imagelightbox-close" title="Close"></a>').appendTo("body").on("click touchend",function(){return e(this).remove(),t.quitImageLightbox(),!1})},r=function(){e("#imagelightbox-close").remove()},s=function(){var t=e('a[href="'+e("#imagelightbox").attr("src")+'"] img').attr("alt");t.length>0&&e('<div id="imagelightbox-caption">'+t+"</div>").appendTo("body")},c=function(){e("#imagelightbox-caption").remove()},l=function(t,n){var i=e(n);if(i.length){for(var o=e('<div id="imagelightbox-nav"></div>'),a=0;a<i.length;a++)o.append('<button type="button"></button>');o.appendTo("body"),o.on("click touchend",function(){return!1});var r=o.find("button");r.on("click touchend",function(){var n=e(this);return i.eq(n.index()).attr("href")!=e("#imagelightbox").attr("src")&&t.switchImageLightbox(n.index()),r.removeClass("active"),r.eq(n.index()).addClass("active"),!1}).on("touchend",function(){return!1})}},d=function(t){var n=e("#imagelightbox-nav button");n.removeClass("active"),n.eq(e(t).filter('[href="'+e("#imagelightbox").attr("src")+'"]').index(t)).addClass("active")},u=function(){e("#imagelightbox-nav").remove()},f=function(t,n){var i=e('<i class="fa fa-chevron-left imagelightbox-arrow imagelightbox-arrow-left"></i><i class="fa fa-chevron-right imagelightbox-arrow imagelightbox-arrow-right"></i>');i.appendTo("body"),i.on("click touchend",function(i){i.preventDefault();var o=e(this),a=e(n+'[href="'+e("#imagelightbox").attr("src")+'"]'),r=a.index(n);return o.hasClass("imagelightbox-arrow-left")?(r-=1,e(n).eq(r).length||(r=e(n).length)):(r+=1,e(n).eq(r).length||(r=0)),t.switchImageLightbox(r),!1})},h=function(){e(".imagelightbox-arrow").remove()};e('a[data-imagelightbox="a"]').imageLightbox({onLoadStart:function(){t()},onLoadEnd:function(){n()},onEnd:function(){n()}}),e('a[data-imagelightbox="b"]').imageLightbox({onStart:function(){i()},onEnd:function(){o(),n()},onLoadStart:function(){t()},onLoadEnd:function(){n()}});var p=e('a[data-imagelightbox="c"]').imageLightbox({quitOnDocClick:!1,onStart:function(){a(p)},onEnd:function(){r(),n()},onLoadStart:function(){t()},onLoadEnd:function(){n()}});e('a[data-imagelightbox="d"]').imageLightbox({onLoadStart:function(){c(),t()},onLoadEnd:function(){s(),n()},onEnd:function(){c(),n()}});var g='a[data-imagelightbox="g"]',m=e(g).imageLightbox({onStart:function(){f(m,g)},onEnd:function(){h(),n()},onLoadStart:function(){t()},onLoadEnd:function(){e(".imagelightbox-arrow").css("display","block"),n()}}),v='a[data-imagelightbox="e"]',b=e(v).imageLightbox({onStart:function(){l(b,v)},onEnd:function(){u(),n()},onLoadStart:function(){t()},onLoadEnd:function(){d(v),n()}}),y='a[data-imagelightbox="f"]',x=e(y).imageLightbox({onStart:function(){i(),a(x),f(x,y)},onEnd:function(){o(),c(),r(),h(),n()},onLoadStart:function(){c(),t()},onLoadEnd:function(){s(),n(),e(".imagelightbox-arrow").css("display","block")}})}),e(".trigger").on("click",function(){e(".content").hide("fade"),e("."+e(this).data("rel")).show("fade")}),e(".js-abrir-modal").on("click",function(){e("div").removeClass("mm-slideout"),e(".modal").css("display","inline-block")}),e(".js-cerrar-modal").on("click",function(){e(".modal").css("display","none"),e("div").addClass("mm-slideout")})}(jQuery);var $=jQuery.noConflict();